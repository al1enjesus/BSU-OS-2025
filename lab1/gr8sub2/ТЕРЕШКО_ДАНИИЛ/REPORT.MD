# Лабораторная 1 — Bash: Анализ логов

Короткая практика по работе с файлами логов в Linux с использованием базовых инструментов командной строки.

## Цели:

Научиться работать с файлами логов в Linux с помощью базовых инструментов командной строки.

## Среда и данные:
- Linux Ubuntu 24.04.03 LTS на виртуальной машине VirtualBox
- Логи для анализа:
  - `/var/log/syslog`
  - `/var/log/auth.log`
  - `/var/log/dpkg.log`

## Задание А) Частотный анализ слов в syslog (TOP‑5):
- Подсчитайте 5 самых частых “слов” в `/var/log/syslog` (нормализуйте регистр, отделяйте слова).

### Шаги решения:
1. Просмотр файла лога
2. Нормализация текста (приведение к нижнему регистру, разделение слов)
3. Подсчет частоты встречаемости слов
4. Сортировка по убыванию частоты
5. Вывод топ-5 результатов(первых пяти)

### Команды:
```bash
cat /var/log/syslog \
  | tr -cs '[:alnum:]' '\n' \
  | tr '[:upper:]' '[:lower:]' \
  | sort \
  | uniq -c \
  | sort -nr \
  | head -n 5
```

### Результат:
```bash
  34258 00
  29813 09
  29288 virtualbox
  29253 2025
  29185 teres
```

### Как проверяли:
- Проверили наличие файла /var/log/syslog
- Убедились, что команда выполняется без ошибок
- Верифицировали логику конвейера на небольшом тестовом наборе данных

### Ключевые выводы:
Анализ показал, что наиболее часто встречающиеся элементы в системном логе представляют собой преимущественно числовые последовательности.
Это связано с тем, что в процессе нормализации текста все неалфавитно-цифровые символы были заменены на переносы строк, что привело к выделению различных технических данных: временных меток,
кодов состояний, идентификаторов ошибок, IP-адресов и номеров портов. Среди числовых значений также присутствует слово "virtualbox", 
что указывает на активное взаимодействие системы с виртуальной машиной, в среде которой работает данная Ubuntu.

## Задание Б) Неудачные попытки входа (auth.log):
-Найдите строки, в которых обозначены неудачные попытки входа, извлеките IP-адреса, посчитайте топ-10 источников и замаскируйте последний октет IP с помощью sed.

### Шаги решения:
При выполнении первоначальной команды `grep -E 'Failed|Invalid' /var/log/auth.log` были обнаружены только записи, связанные с ошибками активации службы Bluetooth (org.bluez), но отсутствовали данные о неудачных попытках входа в систему.Поэтому для демонстрации работы команды и выполнения задания был создан тестовый файл `logs/auth_test.log` с примерами неудачных попыток аутентификации.

1. Поиск строк с неудачными попытками входа
2. Извлечение IP-адресов из найденных записей  
3. Маскировка последнего октета IP-адресов
4. Подсчет частоты замаскированных IP-адресов
5. Сортировка и вывод топ-10 результатов

### Команды:
```bash
grep -E 'Failed|Invalid' logs/auth_test.log \
  | grep -E -o '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' \
  | sed -E 's/([0-9]+\.[0-9]+\.[0-9]+\.)[0-9]+/\1x/g' \
  | sort \
  | uniq -c \
  | sort -nr \
  | head -n 10
```

### Результат:
```bash
  6 192.168.1.x
  4 10.0.0.x
```

### Как проверяли:
- Убедились, что тестовый файл создан корректно и содержит ожидаемые данные
- Проверили, что регулярное выражение для извлечения IP-адресов работает правильно
- Убедились, что маскировка последнего октета применяется корректно
- Верифицировали подсчет частоты IP-адресов

### Ключевые выводы:
Анализ показал, что наиболее активные попытки несанкционированного доступа происходят с IP-адресов сети 192.168.1.x (6 попытки) и 10.0.0.x (4 попытки).

## Задание В) Установки пакетов (dpkg.log):
-Посчитайте, какие пакеты устанавливась чаще всего, выведите топ-10 пакетов с количеством установок.

### Шаги решения:
1. Поиск и подсчет пакетов
2. Вывод топ-10 пакетов с количеством установок 

### Команды:
```bash
grep " install " /var/log/dpkg.log | awk '{print $4}' | cut -d: -f1 | sort | uniq -c | sort -nr | head -n 10
```

### Результат:
```bash
      1 zstd
      1 zlib1g
      1 zip
      1 zenity-common
      1 zenity
      1 yelp-xsl
      1 yelp
      1 yaru-theme-sound
      1 yaru-theme-icon
      1 yaru-theme-gtk
```

### Как проверяли:
- Проверили доступность файла
- Работу фильтрации установок
- Извлечения имён пакетов и корректность подсчёта.

### Ключевые выводы:
Анализ лога установки пакетов показал, что в системе было установлено множество различных пакетов, каждый из которых устанавливался по одному разу.
Это свидетельствует о том, что система относительно новая или недавно настроенная.

## Как использовали ИИ:
- Объяснение работы сложных конструкций (regex, sed, awk, конвейеры)
- Помощь в создании тестового файла auth_test.log для задания Б
- Отладка и исправление ошибок в командах
- Формулировка выводов на основе полученных результатов

## Итоги
-При выполнении лабораторной работы успешно освоены и закреплены команды для работы с различными файлами логов через командную строку.




