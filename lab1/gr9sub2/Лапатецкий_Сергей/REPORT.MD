# Лабораторная 1 — Bash: анализ логов

### Как проверить?
Файлы скриптов лежат в ./src/ они обращаются к копиям логов расположенных в ./logs/  
Выполнение скриптов даст нужные результаты обеспечив воспроизводимость.

## Заданиe A

### Цель
Частотный анализ слов в syslog (TOP‑5)
- Подсчитайте 5 самых частых “слов” в `/var/log/syslog` (нормализуйте регистр, отделяйте слова).

### Шаги решения
После модификации пути к логам в примере конвейера получился скрипт(./src/A.sh), при выполнении которого получим 5 самых частых слов в копии системных логов(./logs/syslog)  

### Полученный результат:
```
    8464 00
    6242 desktop
    6034 09
    5925 killerser
    5924 2025
```
### Ключевые выводы
Так как в каждой строчке логов встречается дата, время, часовой пояс, имя уч. записи, то легко определить, что они встретяться в топ 5. Таким образом killerser-desktop это имя уч. записи встречается на 2 и 4 месте. 3 место это месяц. 5 место это год. 1 место занимают 2 нуля, так как до изменения часового пояса он был 00:00, а после стал 03:00, значит 00 будет встречаться чаще всего.

## Заданиe Б

### Цель
Неудачные попытки входа (auth.log)
- Найдите строки с Failed или Invalid в /var/log/auth.log.
- Извлеките IP‑адреса, посчитайте TOP‑10 источников.
- Замаскируйте последний октет IP (например, 192.168.0.15 → 192.168.0.x) с помощью sed.

### Шаги решения
Используя команду `grep` с флагом `-E` найдём строки содержащие Failed или Invalid применив регулярное выражение `(Failed|Invalid)`. Далее используя `grep` с флагом `-E` и `-o` для того чтобы получить только слово, а не всю строку, выделим ip-адреса применив регулярное выражение `\b([0-9]{1,3}\.){3}[0-9]{1,3}\b`. Далее считаем полученные адреса и выводим топ-10 как в задании А. В конце применив команду `sed` из подсказки замаскируем последний октет. Полученный скрипт можно найти по пути ./src/B.sh  

### Полученный результат:
```
    4 192.168.64.x
```
### Ключевые выводы
Изначально в логах аунтификации не было ip адресов так как к виртуальной машине не было попыток подключения по сети. Для решения этого вопроса я подключился к виртуальной машине из хоста при помощи команды `ssh username@ip`. После ввода неправильного пароля и неправильного username в логах появились записи удовлетворяющие условиям задания. ip адрес в результате совпадал с ip адресом хоста.

## Заданиe В

### Цель
Установки пакетов (dpkg.log)
- По /var/log/dpkg.log посчитайте, какие пакеты устанавливались чаще всего (события install).
- Выведите TOP‑10 пакетов с количеством установок.

### Шаги решения
Используя команду `grep` найдём строки содержащие `install `. Далее используя `awk '{print $4}'` выводим 4 слово, получая имя пакетов. Далее считаем полученные пакеты и выводим топ-10 как в задании А\Б. Полученный скрипт можно найти по пути ./src/С.sh  

### Полученный результат:
```
    3 7zip:amd64
    1 zstd:amd64
    1 zlib1g:amd64
    1 zip:amd64
    1 zenity-common:all
    1 zenity:amd64
    1 yelp-xsl:all
    1 yelp:amd64
    1 yaru-theme-sound:all
    1 yaru-theme-icon:all
```
### Ключевые выводы
Так как виртуальная машина была создана недавно пакеты устанавливались впервые. Перед выполнением задания я установил и удалил пакет 7zip пару раз, чтобы проверить работу скрипта. По результатам видно, что скрипт работает.