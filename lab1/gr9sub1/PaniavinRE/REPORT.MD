Лабораторная работа №1 - Анализ логов Bash

Роман Понявин
gr9sub1

Цель работы:
Освоить базовые инструменты командной строки Linux (grep, sed, awk, sort, uniq, etc.) для анализа текстовых логов

Исходные данные:
*   ОС: Ubuntu 24.04 LTS
*   Анализируемые файлы:
    *   /var/log/syslog
    *   /var/log/auth.log
    *   /var/log/dpkg.log

Задание A: TOP-5 слов в syslog

Цель: Подсчитать 5 самых частых слов

Исходная команда (выдала неинформативный результат):
sudo cat /var/log/syslog | tr -cs '[:alnum:]' '\n' | tr '[:upper:]' '[:lower:]' | sort | uniq -c | sort -nr | head -n 5
Результат:
  *b 36267 00
  * 17031 09
  * 16769 2025
  * 16768 riman
  * 14092 21t15
Улучшенная команда (игнорирует чисто числовые последовательности и короткие слова):
cat /var/log/syslog | awk '{for(i=1;i<=NF;i++) print tolower($i)}' | grep -E '^[a-z]{4,}' | sort | uniq -c | sort -nr | head -n 5
  * 16786 riman
   * 5750 kernel:
  * 4092 systemd[1]:
   * 1344 keysym
   * 1282 file
Вывод: Первоначальная команда выводила в топе числовые значения (00, 09 и т.д.) и фрагменты временных меток, так как они являются частыми элементами в логах. После фильтрации коротких слов и числовых последовастей наиболее частыми оказались имя пользователя riman и системные компоненты (kernel, systemd), что отражает активность системы и пользовательские сессии.

Задание B: TOP-10 IP с неудачными попытками входа

Цель: Найти и замаскировать IP-адреса источников неудачных попыток входа
Проблема: Изначально команда grep выдавала предупреждение binary file matches для файла /var/log/auth.log
Решение: Использование опции -a для обработки файла как текстового
Команда:
sudo grep -a -i 'failed\|invalid' /var/log/auth.log | grep -Eo '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' | sort | uniq -c | sort -nr | head -n 10 | sed -E 's/([0-9]+\.[0-9]+\.[0-9]+\.)[0-9]+/\1x/g'

Результат:
(Команда не вывела результатов, так как в логе не найдено записей с IP-адресами)
Анализ лога вручную:
sudo grep -a -i 'failed\|invalid' /var/log/auth.log
Результат анализа:
Были обнаружены записи о неудачных попытках входа через /dev/tty1, но они не содержат IP-адресов, так как попытки были локальными, а не сетевыми.
2025-09-21T15:10:58.183273+00:00 riman login[955]: FAILED LOGIN (1) on '/dev/tty1' FOR 'UNKNOWN', Authentication failure
2025-09-21T15:11:07.920393+00:00 riman login[955]: FAILED LOGIN (2) on '/dev/tty1' FOR 'riman', Authentication failure
Вывод: В ходе анализа не было обнаружено неудачных попыток входа по сети, которые содержали бы IP-адреса. Все попытки были локальными, через виртуальный терминал

Задание C: TOP-10 устанавливаемых пакетов
Цель: Найти пакеты, которые устанавливались чаще всего.
Команда:
sudo grep 'install ' /var/log/dpkg.log | awk '{print $5}' | cut -d: -f1 | sort | uniq -c | sort -nr | head -n 10
Результат:
   1673 <none>
Вывод: Анализ лога /var/log/dpkg.log показал, что наиболее частой операцией, классифицируемой системой как "install", является служебная операция с меткой <none> (1673 раза). Это связано с тем, что в Ubuntu данная метка используется в процессе обновления пакетов (upgrade), когда старые версии помечаются на удаление. Таким образом, полученный результат не означает установку одноименного пакета, а отражает общую высокую активность по обновлению системы в течение ее жизненного цикла.
Использование ИИ
•	При выполнении работы был использован ИИ (ChatGPT) для:
•	Объяснения причины появления числовых данных в результате задания А.
•	Поиска решения проблемы с бинарным файлом auth.log (опция -a для grep).
•	Объяснения природы записи <none> в логах dpkg.

Заключение:
В ходе работы были успешно освоены основные инструменты CLI для обработки текстовых данных. Навыки фильтрации (grep), преобразования (tr, awk), агрегации (sort, uniq) и извлечения данных были применены для анализа системных логов. Возникшие проблемы (бинарный формат логов, неочевидные результаты) были решены через анализ и уточнение команд
