# Лабораторная 1 — Bash: анализ логов
Короткая практика по работе с файлами логов в Linux с использованием базовых инструментов командной строки.

## Цели
Научиться работать с файлами логов в Linux с помощью базовых инструментов командной строки.

Ubuntu 24.04.3 на VirtualBox.

## Задания

А) Частотный анализ слов в syslog (TOP‑5)
Цель: Нормализовать регистр, отделить слова и подсчитать 5 самых частых "слов" в /var/log/syslog.

Шаги/решения:
    - Чтение файла /var/log/syslog с помощью cat (чтение всего файла)
    - Перевод всех символов в нижний регистр
    - Разделение текста на слова (символы, которые не являются буквами или цифрами, заменяются на перенос строк)
    - Сортировка слов в алфавитном порядке
    - Подсчет количества вхождений каждого уникального слова
    - Сортировка по количеству в порядке убывания
    - Вывод первых 5 результатов (т.е. топ-5 самых частых слов)
    
Команда:

    cat /var/log/syslog | tr '[:upper:]' '[:lower:]' | tr -cs '[:alnum:]' '\n' | sort | uniq -c | sort -nr | head -n 5
  
Результат:

   4413 00
   3480 09
   3341 03
   3334 2025
   3310 virtualbox
    
Выводы:
   Поскольку мы все символы, которые не являются буквами и цифрами, заменили переносом строки, то в топ-5 слов почти все слова - числовые последовательности: временные метки логов, код состояний и ошибок, IP-адреса и порты, идентификаторы, номера сообщений в логах. Также в топ-5 присутствует "virtualbox" - поскольку ubuntu запущен с помощью виртуальной машины VirtualBox, то в логах много записей, связанных с виртуальной машинной.
    
Использование ИИ:
    Более подробное описание команд и их применение.
    
Б) Неудачные попытки входа (auth.log)
Цель: найти строки, в которых обозначены неудачные попытки входа, извлечь IP-адреса, посчитать топ-10 источников и замаскировать последний октет IP с помощью sed.

Шаги/решения:
    - Поиск строк с Failed или Invalid в /var/log/auth.log
    - Извлечь IP-адреса
    - Посчитать топ-10 источников
    - Замаскировка последний октет IP
    - Подсчет частоты появления каждого маскированного IP

Команды:

    grep -E 'Failed|Invalid' /var/log/auth.log

    grep -E 'Failed|Invalid' /var/log/auth.log | grep -oE '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+'

    grep -E 'Failed|Invalid' /var/log/auth.log | grep -oE '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' | sort | uniq -c | sort -nr | head -n 10

    grep -E 'Failed|Invalid' /var/log/auth.log | grep -oE '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' | sort | uniq -c | sort -nr | head -n 10 | sed -E 's/([0-9]+\.[0-9]+\.[0-9]+\.)[0-9]+/\1x/g'

Результат:
    Логи с неудачным входом не найдены, поэтому был создан искусственно файл с неудачными попытками входа для проверки работы команд. 
    
Команды:

    grep -E 'Failed|Invalid' auth_test.log

    grep -E 'Failed|Invalid' auth_test.log | grep -oE '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+'

    grep -E 'Failed|Invalid' auth_test.log | grep -oE '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' | sort | uniq -c | sort -nr | head -n 10

    grep -E 'Failed|Invalid' auth_test.log | grep -oE '[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+' | sed -E 's/([0-9]+\.[0-9]+\.[0-9]+\.)[0-9]+/\1x/g' | sort | uniq -c | sort -nr | head -n 10

Результаты:

    192.168.1.10
    10.0.0.5
    203.0.113.20
    192.168.1.10
    10.0.0.5
    10.0.0.5
    198.51.100.30
    192.168.1.10
    10.0.0.5
    203.0.113.20
    10.0.1.6

    4 10.0.0.5
    3 192.168.1.10
    2 203.0.113.20
    1 198.51.100.30
    1 10.0.1.6

    4 10.0.0.x
    3 192.168.1.x
    2 203.0.113.x
    1 10.0.1.x
    1 198.51.100.x
   
Выводы:
    Команды для тестового файла с неудачными входами выполнены успешно. В списке IP-адресов с маскированным октетом всего 4 позиции (суммарно все 11 IP-адресов из файла auth_test.log), а не 5, потому что больше IP-адресов нету.
    
Использование ИИ:
    Помощь в создании файла с недучными входами для теста команд, помощь в правильной записи команд для выполнения поставленной задачи.
    
В) Установки пакетов (dpkg.log)
Цель: Посчитать, какие пакеты устанавливась чаще всего, вывести топ-10 пакетов с количеством установок.

Шаги/решения:
     - Поиск и подсчет пакетов
     - Вывод топ-10 пакетов с количеством установок 
    
Команда:
    grep " install " /var/log/dpkg.log | awk '{print $4}' | cut -d: -f1 | sort | uniq -c | sort -nr | head -n 10
  
Результат:

    1 zstd
    1 zlib1g
    1 zip
    1 zenity-common
    1 zenity
    1 yelp-xsl
    1 yelp
    1 yaru-theme-sound
    1 yaru-theme-icon
    1 yaru-theme-gtk


Выводы:
    Поскольку работа с система Ubuntu установлена только полторы недели назад и виртуальная машина с Ubuntu используется только в 4ый раз, то все утилиты и библиотеки скачаны максимум 1 раз.
    
Использование ИИ:
    Помощь в создании команды.

## Итоги
  При выполнении лабораторной работы успешно освоены и закреплены команды для работы с различными файлами логов через командную строку.
